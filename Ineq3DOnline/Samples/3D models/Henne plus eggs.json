{"name":"3D models\\Henne plus eggs","x0":-1.0,"y0":-1.0,"z0":-1.0,"x1":1.0,"y1":1.0,"z1":1.0,"maxDivisionCount":12,"quality":false,"curvatureQuality":false,"formula":"[advanced]\r\n\r\nprivate SignedDistance sdf = new SignedDistance(\"Henne.stl\");\r\n\r\npublic IneqTree Eggs(int count)\r\n{\r\n    IneqTree res = new IneqTree();\r\n\tRandom random = new Random();\r\n  \tList<Point> points = new List<Point>();\r\n  \r\n    for (int i = 0; i < count; i++)\r\n    {\r\n\t\tPoint p = new Point(\r\n          random.NextDouble() * 1.6d - 0.8d, \r\n          random.NextDouble() * 1.6d - 0.8d, \r\n          random.NextDouble() * 0.3d - 0.7d);\r\n\r\n\t\t//if(abs(sdf.From(p.X, p. Y, p. Z)) < 0.1d)\r\n        {\r\n\t\t\tsdf.Project(p);\r\n          \tif(!points.Any(p1 => p1.Distance(p) < 3.0d * 0.1d))\r\n            {              \r\n          \t\tpoints.Add(p);\r\n              \r\n              \tdouble nx, ny, nz;\r\n              \tGradient(sdf.From, p, out nx, out ny, out nz);\r\n              \r\n              \tvar m =  ComputeBasis(nx, ny, nz, 'z');\r\n              \r\n          \t\tres = res | (#\r\n                    {\r\n\t\t\t\t\t\tTransform(ref x, ref y, ref z, p, m);\r\n                             \r\n\t\t\t\t\t\tx = x * 10;\r\n\t\t\t\t\t\ty = y * 10;                             \r\n\t\t\t\t\t\tz = z * 10;\r\n                             \r\n\t\t\t\t\t\treturn sqrt(pow(pow(x,2)+pow(y,2)+pow(z,2)/2.25d,3))-pow(x,2)-pow(y,2)-pow(z,2)/2.25d;\r\n                      }\r\n\t\t\t\t\t);\r\n            }              \r\n        }\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\npublic IneqMesh GetIneqMesh()\r\n{\r\n\tvar f = sdf.From;\r\n\tvar b = new IneqTree(f) ;  \r\n\r\n  var res = new IneqMesh\r\n    {\r\n        X0 = -1,\r\n        Y0 = -1,\r\n        Z0 = -1,\r\n        X1 = 1,\r\n        Y1 = 1,\r\n        Z1 = 1,\r\n        D = 0.05,\r\n        Boxed = true,\r\n        IneqTree =\r\n          (b | Eggs(40)) & !(# z+0.95)\r\n\t};\r\n  \tres.ProjectToSurfaceSpec[f] = sdf.Project;\r\n  \tres.PrepareBackgroundMesh = () => res.RefineTetrahedralMeshByTetrahedrons(0, 10, 0.1);\r\n  \r\n  \treturn res;  \r\n}\r\n\t"}