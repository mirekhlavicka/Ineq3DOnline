{"name":"3D models\\Simple Cat plus small 6-balls","x0":-1.0,"y0":-1.0,"z0":-1.0,"x1":1.0,"y1":1.0,"z1":1.0,"maxDivisionCount":12,"quality":false,"curvatureQuality":false,"formula":"[advanced]\r\n\r\nprivate SignedDistance sdf = new SignedDistance(\"SimpleCat.stl\");\r\n\r\npublic IneqTree Balls(int count, double r, double pp,  out List<Point> points)\r\n{\r\n    IneqTree res = new IneqTree();\r\n\tRandom random = new Random();\r\n  \tpoints = new List<Point>();\r\n  \r\n    for (int i = 0; i < count; i++)\r\n    {\r\n\t\tPoint p = new Point(\r\n          random.NextDouble() * 1.6d - 0.8d, \r\n          random.NextDouble() * 1.6d - 0.8d, \r\n          random.NextDouble() * 1.6d - 0.8d);\r\n\r\n\t\t//if(abs(sdf.From(p.X, p. Y, p. Z)) < 0.1d)\r\n        {\r\n\t\t\tsdf.Project(p);\r\n          \tif(!points.Any(p1 => p1.Distance(p) < 2.5d * r))\r\n            {              \r\n          \t\tpoints.Add(p);\r\n              \r\n              \tdouble nx, ny, nz;\r\n              \tGradient(sdf.From, p, out nx, out ny, out nz);\r\n              \r\n              \tvar m =  ComputeBasis(nx, ny, nz);\r\n              \r\n          \t\tres = res | (# \r\n\t\t\t\t{\r\n                  Transform(ref x, ref y, ref z, p, m);\r\n                  \r\n                  return\r\n\t\t\t\t\tpow(abs(x), pp) +\r\n\t\t\t\t\tpow(abs(y), pp) +\r\n\t\t\t\t\tpow(abs(z), pp) -\r\n\t\t\t\t\tpow(r, pp); \r\n                });\r\n            }              \r\n        }\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\npublic IneqMesh GetIneqMesh()\r\n{\r\n\tvar f = sdf.From;\r\n\tvar b = new IneqTree(f) ;  \r\n  \tList<Point> points = null;\r\n  \r\n  \tvar res = new IneqMesh\r\n    {\r\n        X0 = -1.1,\r\n        Y0 = -1.1,\r\n        Z0 = -1.1,\r\n        X1 = 1.1,\r\n        Y1 = 1.1,\r\n        Z1 = 1.1,\r\n        D = 0.1,\r\n        Boxed = true,\r\n        IneqTree =\r\n          b | Balls(30, 0.05, 6, out points)\r\n\t};\r\n  \tres.ProjectToSurfaceSpec[f] = sdf.Project;\r\n\r\n  \tres.PrepareBackgroundMeshBeforeApriory = () => \r\n    {\r\n\t\tres.RefineTetrahedralMeshNearPointRedGreen(points, 0.05, 3);     \r\n\t\tres.RefineTetrahedralMesh(0, 10, 0.1);      \r\n    };    \r\n  \r\n  \treturn res;  \r\n}\r\n"}