{"name":"Bottle\\Wine Mug","x0":-1.0,"y0":-1.0,"z0":-1.0,"x1":1.0,"y1":1.0,"z1":1.0,"maxDivisionCount":12,"quality":false,"curvatureQuality":false,"formula":"[advanced]\r\n\r\nprivate double Bump(double x)\r\n{\r\n  if (x <= -1 || x >= 1)\r\n    return 0.0;\r\n\r\n  double t = 1 - x * x;      // 1 - x^2\r\n  return Math.Exp(-1 / t) / Math.Exp(-1);  // normalized so f(0) = 1\r\n}\r\n\r\nprivate IneqTree Mug(double dr = 0)\r\n{\r\n\tdouble[] z =  { -1,   -0.5, 0,   0.5,   1 };\r\n\tdouble[] rz = { 0.55, 0.85, 0.55,0.3, 0.4  };\r\n  \r\n\tFunc<double,double> rf = Interpolation.CubicSpline(z,rz);\r\n  \r\n\tdouble[] a =  { -PI, -PI + 0.5, -PI/2, 0, PI /2, PI - 0.5, PI };\r\n\tdouble[] fa = {  1,  0.6     ,  1,     1, 1,     0.6,     1  };\r\n  \r\n\tFunc<double,double> angf = Interpolation.CubicSpline(a,fa);\r\n\r\n  \r\n  \tFuncXYZ f = (x,y,z) => \r\n    {\r\n      \tvar b = Bump((z-1));\r\n      \tvar aa = atan2(y,x);\r\n      \r\n      \tvar r0 = rf(z);\r\n\t\t\r\n\t\tvar r = (b * angf(aa) + 1 - b) * r0 - dr;                        \r\n      \r\n\t\treturn x*x + y*y - r;      \r\n    };\r\n  \t\r\n  \treturn f & (# -z +(-1 + dr)  ) ;\r\n}\r\n\r\npublic IneqTree TorusPQ(double x0, double y0, double z0, double r, double R)\r\n{\r\n\r\n    return new IneqTree((x, y, z) =>\r\n    {\r\n\t\tdouble p, q;\r\n\r\n      \tx = x - x0;\r\n        y = y - y0;\r\n        z = z - z0;      \r\n\r\n      \tp = z < 0 ? 2 : 3;\r\n      \tq = 6;\r\n      \r\n      \tdouble pn = pow(pow(abs(x), p) + pow(abs(z), p), 1.0d/p);\r\n      \r\n      \tdouble sx =  R * x / pn;\r\n      \tdouble sz =  R * z / pn;\r\n\r\n\t\tdouble v = sqrt((x-sx)*(x-sx) + (z-sz)*(z-sz));\r\n      \r\n      \treturn pow(pow(y, q) + pow(2*v, q), 1.0/q) - r;\r\n\r\n    });\r\n}\r\n\r\n\r\npublic IneqMesh GetIneqMesh()\r\n{\r\n    return new IneqMesh\r\n    {\r\n        X0 = -1.1,\r\n        Y0 = -1.1,\r\n        Z0 = -1.1,\r\n        X1 = 1.5,\r\n        Y1 = 1.1,\r\n        Z1 = 1.1,\r\n        D = 0.1d,\r\n        Boxed = false,\r\n        IneqTree = ((TorusPQ(0.73, 0, 0.2, 0.15, 0.5) | Mug()) & !Mug(0.05)) & (# z - 1)\r\n      };\r\n}\r\n"}